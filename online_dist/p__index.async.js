"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[866],{56266:function(me,A,n){n.r(A),n.d(A,{default:function(){return _}});var J=n(17061),d=n.n(J),L=n(17156),T=n.n(L),Q=n(861),K=n.n(Q),U=n(27424),o=n.n(U),m=n(62435),z=n(1993),W=n(64317),X=n(97462),p=n(31199),R=n(96108),Y=n(96549),b=n(75081),D=n(36809),w=n(25035),g=n(63051),k=n(5234),q=n(27496),e=n(86074),E=function(i){var h=i.onChange,I=i.value,M=i.onClick,u=i.formRef,v=i.id,f=(u==null?void 0:u.getFieldError(v))||[];return(0,e.jsxs)("div",{className:"auto-textarea ".concat(f.length>0?"auto-textarea-error":""),style:{display:"flex",alignItems:"flex-end",gap:4},children:[(0,e.jsx)(k.Z.TextArea,{autoSize:!0,onChange:h,value:I}),(0,e.jsx)("div",{className:"submit",onClick:M,children:(0,e.jsx)(q.Z,{})})]})};console.log(E);function $(){var i=(0,m.useState)(""),h=o()(i,2),I=h[0],M=h[1],u=(0,m.useState)([]),v=o()(u,2),f=v[0],O=v[1],ee=(0,m.useState)("text"),G=o()(ee,2),he=G[0],ve=G[1],ne=(0,m.useRef)(null),te=R.Z.useForm(),se=o()(te,1),x=se[0],re=Y.ZP.useMessage(),P=o()(re,2),ae=P[0],ie=P[1],le=function(r){O([].concat(K()(f),[{type:"question",content:r.q,isFinshed:1},{type:"answer",content:"\u6B63\u5728\u601D\u8003",isFinshed:0}])),x.setFieldsValue({q:""}),oe(r)},oe=function(){var s=T()(d()().mark(function r(t){var l;return d()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:l={q:t.q,t:t.type},t.type==="image"&&(l.n=t.n?parseInt(t.n):1,t.width&&t.height&&(l.size="".concat(t.width,"x").concat(t.height))),fetch("http://chatapi.cfyhome.com:7001/api/openai",{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify(l)}).then(function(){var j=T()(d()().mark(function B(ue){var a;return d()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,ue.json();case 2:a=c.sent,console.log(a),O(function(H){return H.map(function(ce,de){if(de<H.length-1)return ce;var C;if(t.type==="text"){var F,S,Z,N;C=a==null||(F=a.data)===null||F===void 0||(S=F[0])===null||S===void 0||(Z=S.message)===null||Z===void 0||(N=Z.content)===null||N===void 0?void 0:N.replace(/\n{2}/," ")}return t.type==="image"&&(C=(a==null?void 0:a.data)||[]),{type:t.type,content:C,isFinshed:1}})});case 5:case"end":return c.stop()}},B)}));return function(B){return j.apply(this,arguments)}}()).catch(function(j){ae.open({type:"error",content:j.message})});case 3:case"end":return y.stop()}},r)}));return function(t){return s.apply(this,arguments)}}();return(0,e.jsxs)("div",{className:"App",children:[ie,(0,e.jsx)("div",{className:"answer_box",children:(0,e.jsx)("div",{className:"answer",children:f.map(function(s,r){if(s.type==="question")return(0,e.jsxs)("div",{className:"item",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(w.Z,{style:{fontSize:"24px",color:"#646cffaa"}})," "]}),(0,e.jsx)("span",{className:"span",children:s.content})]},r);if(s.isFinshed===0)return(0,e.jsxs)("div",{className:"item",ref:ne,children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(g.Z,{style:{fontSize:"24px",color:"#42b883aa"}})," "]}),(0,e.jsx)("span",{className:"span",children:(0,e.jsx)(b.Z,{})})]},r);if(s.type==="text")return(0,e.jsxs)("div",{className:"item",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(g.Z,{style:{fontSize:"24px",color:"#42b883aa"}})," "]}),(0,e.jsx)("span",{className:"span",children:s.content})]},r);if(s.type==="image")return(0,e.jsxs)("div",{className:"item",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(g.Z,{style:{fontSize:"24px",color:"#42b883aa"}})," "]}),(0,e.jsx)("span",{className:"span",style:{display:"flex",gap:8},children:(0,e.jsx)(D.Z.PreviewGroup,{preview:{onChange:function(l,V){return console.log("current index: ".concat(l,", prev index: ").concat(V))}},children:s.content.map(function(t){return(0,e.jsx)(D.Z,{width:200,src:t.url})})})})]},r)})})}),(0,e.jsx)("div",{className:"input",children:(0,e.jsxs)(z.A,{initialValues:{type:"text",n:1,width:1024,height:1024},form:x,submitter:{searchConfig:{submitText:"\u63D0\u95EE"},render:function(r,t){return null}},onFinish:le,children:[(0,e.jsxs)(z.A.Group,{children:[(0,e.jsx)(W.Z,{options:[{label:"\u6587\u672C\u5BF9\u8BDD",value:"text"},{label:"AI\u56FE\u7247",value:"image"}],name:"type",label:"\u7C7B\u578B",rules:[{required:!0}]}),(0,e.jsx)(X.Z,{name:["type"],children:function(r){var t=r.type;return t==="image"?(0,e.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,e.jsx)(p.Z,{name:"n",label:"\u56FE\u7247\u6570\u91CF",min:1,max:9}),(0,e.jsx)(p.Z,{name:"width",label:"\u56FE\u7247\u5BBD(\u50CF\u7D20)",min:100,max:1920}),(0,e.jsx)(p.Z,{name:"height",label:"\u56FE\u7247\u9AD8(\u50CF\u7D20)",min:100,max:1920})]}):null}})]}),(0,e.jsx)(R.Z.Item,{name:"q",label:"\u95EE\u9898",rules:[{required:!0}],children:(0,e.jsx)(E,{onClick:function(){return x.submit()},formRef:x})})]})})]})}var _=$}}]);
